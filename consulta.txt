SELECT

itempedido.id_produto AS id,
produto.nome_produto AS nome,
itempedido.valor AS valor,
sum(itempedido.prod_quantidade) AS qts_vendidos,
sum(itempedido.valor * itempedido.prod_quantidade) AS total_vendido

FROM produto

JOIN itempedido ON produto.id_produto = itempedido.id_produto
JOIN pedido ON pedido.id_pedido = itempedido.id_pedido

where pedido.status_pedido = 2

GROUP BY

itempedido.id_produto,
produto.nome_produto,
itempedido.valor

ORDER BY

qts_vendidos;
   
   -- ver total de vendidos





select produto.nome_produto,
 count(produto.nome_produto) as vendidos
from itempedido
cross join pedido on itempedido.id_pedido = pedido.id_pedido
cross join produto on itempedido.id_produto = produto.id_produto
where pedido.status_pedido = 2
group by produto.nome_produto
order by count(produto.nome_produto)desc
limit 1;

-- produto mais popular /\



select pedido.Id_Pedido, pedido.Id_Cli,
cliente.Nome, cliente.Sobrenome,
cliente.Cpf_Cli, cliente.Celular,
cliente.Endereco, cliente.Email,
 pedido.Data_Pedido, pedido.Data_Cancelamento,
 pedido.Observacao, pedido.Motivo_Cancelamento,
 pedido.Status_pedido,
 itempedido.Id_Produto, produto.Nome_Produto,
 itempedido.Valor, itempedido.Prod_Quantidade
from pedido 
join cliente, itempedido, produto 
where pedido.Id_Pedido = itempedido.Id_Pedido
and pedido.Id_Cli = cliente.Id_Cli
and itempedido.Id_Produto = produto.Id_Produto
and pedido.Data_pedido between "2022-06-01" and "2022-06-08";

-- pedidos por data /\